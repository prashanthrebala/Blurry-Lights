<!DOCTYPE html>
<style type="text/css">

    @font-face {
        font-family: topfont;
        src: url({{ url_for('static', filename='topfont.ttf') }});
    }

    @font-face {
        font-family: chs;
        src: url({{ url_for('static', filename='lt.otf') }});
    }

    @font-face {
        font-family: hsp;
        src: url({{ url_for('static', filename='hsp.otf') }});
    }

    .hspf {
        font-family: 'hsp';
    }

    .chs {
        font-family: 'chs';
    }

    .afghan {
        font-family: 'topfont'
    }

    html, body {
        height: 100%;
        width: 100%;
        background-image: url({{ url_for('static', filename='./bg3.jpg') }});
        overflow: hidden;
        margin: 0;
        padding: 0;
    }

    #content {
        height: 100%;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-position: center;
    }

    #border-div {
        height: 100%;
        width: 100%;
        background: rgba(34, 34, 34, 0.7);
        color: #eee;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    #top-header {
        height: 30%;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        opacity: 0;
        transition: opacity 600ms ease-in-out;
        -moz-transition: opacity 600ms ease-in-out;
        -webkit-transition: opacity 600ms ease-in-out;
    }

    #bottom {
        height: 70%;
        width: 100%;
        /*background-color: #172638;*/
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    .container {
        height: 300px;
        width: 300px;
        position: relative;
    }

    .canvas {
        border-radius: 25px;
        box-shadow: 0 0 60px #fad390;
    }

    #ggg {
        position: absolute;
        z-index: 999;
        /*display: none;*/
    }

    #hhh {
        height: 100%;
        width: 100%;
        position: absolute;
        top: 0;
        z-index: 1;
        display: none;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    #blurry-lights {
        height: 80%;
        width: 100%;
        display: flex;
        justify-content: center;
        position: relative;
        font-size: 50px;
    }

    #blurry-lights > div {
        position: absolute;
        bottom: 18px;
    }

    #caption {
        height: 20%;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
    }

    #info {
        height: 70%;
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    #info > div {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
    }

    #venue {
        font-size: 20px;
        margin-top: -20px;
    }

    #names {
        height: 30%;
        width: 100%;
    }

    #names {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: row;
        flex-wrap: wrap;
        opacity: 0;
        transition: opacity 1800ms ease-in-out;
        -moz-transition: opacity 1800ms ease-in-out;
        -webkit-transition: opacity 1800ms ease-in-out;
    }

    #names > p {
        margin: 0.2em 0.5em;
        font-size: 1.8em;
    }

    #other-names {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: row;
        flex-wrap: wrap;
    }

    #other-names > p {
        margin: 0.2em 0.5em;
        font-size: 1.8em;
    }

    #info > p {
        text-align: center;
        font-size: 1.2em;
        margin: 0 auto;
    }

    #name {
        font-size: 2.5em !important;
    }

    #venue {
        font-size: 1.5em !important;
    }

    #other-names {
        display: none;
    }

    .show {
        opacity: 1 !important;
    }

    @media only screen and (min-width: 1001px) {
        body {
            background-image: url({{ url_for('static', filename='bg1.jpg') }});
            background-size: 130%;
            background-position: center;
        }
    }

    @media only screen and (max-width: 1000px) and (orientation: landscape) {

        #border-div {
            flex-direction: row;
        }

        #top-header, #bottom {
            height: 100%;
            width: 50%;
        }

        #blurry-lights {
            height: unset;
        }

        #blurry-lights > div {
            position: static;
        }

        #caption {
            height: unset;
            align-items: flex-start;
            margin-top: 0.5em;
            margin-bottom: 10vh;
        }

        #names {
            display: none;
        }

        #other-names {
            display: flex;
            font-size: 0.75em;
            padding: 1.8em;
            margin-bottom: -10vh;
        }

    }

    @media only screen and (max-width: 1000px) and (orientation: portrait) {

        body {
            background-size: 180%;
            background-position: center;
        }

    }

</style>
<html>
<head>
    <title> Blurry Nights</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
<div id="content">
    <div id="border-div">
        <!-- <div id="a"> One or no cheesy line here </div> -->
        <div id="top-header" class="afghan">
            <div id="blurry-lights">
                <div>Blurry Lights</div>
            </div>
            <div id="caption" class="hspf"> Time isn't wasted when you are</div>

            <div id="other-names" class="afghan">
                <p> Varun </p>
                <p> Shaleen </p>
                <p> Prerna </p>
                <p> Prashanth </p>
                <p> Sidharth </p>
            </div>
        </div>
        <div id="bottom">
            <div class="container" id="js-container">
                <div id="ggg">
                    <canvas class="canvas" id="js-canvas" width="300" height="300"></canvas>
                </div>
                <div id="hhh">
                    <div id="info" class="chs">
                        <p id="name"> {{ name }}</p>
                        <p> see you on
                        <p>
                        <p id="venue"> Wednesday <br/> 31st October, 8pm <br/> Blue Waters, Manipal </p>
                    </div>
                </div>
            </div>

            <div id="names" class="chs">
                <p> Varun </p>
                <p> Shaleen </p>
                <p> Prerna </p>
                <p> Prashanth </p>
                <p> Sidharth </p>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    (function () {

        'use strict';

        var isDrawing, lastPoint;
        var container = document.getElementById('js-container'),
            canvas = document.getElementById('js-canvas'),
            canvasWidth = canvas.width,
            canvasHeight = canvas.height,
            ctx = canvas.getContext('2d'),
            image = new Image(),
            brush = new Image();

        // base64 Workaround because Same-Origin-Policy
        image.src = '../static/scratch.png';
        image.onload = function () {
            ctx.drawImage(image, 0, 0);
            $("#hhh").css("display", "flex");
        };
        brush.src = 'data:image/png;base64,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';

        canvas.addEventListener('mousedown', handleMouseDown, false);
        canvas.addEventListener('touchstart', handleMouseDown, false);
        canvas.addEventListener('mousemove', handleMouseMove, false);
        canvas.addEventListener('touchmove', handleMouseMove, false);
        canvas.addEventListener('mouseup', handleMouseUp, false);
        canvas.addEventListener('touchend', handleMouseUp, false);

        function distanceBetween(point1, point2) {
            return Math.sqrt(Math.pow(point2.x - point1.x, 2) + Math.pow(point2.y - point1.y, 2));
        }

        function angleBetween(point1, point2) {
            return Math.atan2(point2.x - point1.x, point2.y - point1.y);
        }

        // Only test every `stride` pixel. `stride`x faster,
        // but might lead to inaccuracy
        function getFilledInPixels(stride) {
            if (!stride || stride < 1) {
                stride = 1;
            }

            var pixels = ctx.getImageData(0, 0, canvasWidth, canvasHeight),
                pdata = pixels.data,
                l = pdata.length,
                total = (l / stride),
                count = 0;

            // Iterate over all pixels
            for (var i = count = 0; i < l; i += stride) {
                //console.log(i);
                if (parseInt(pdata[i]) === 0) {
                    count++;
                }
            }
            return Math.round((count / total) * 100);
        }

        function getMouse(e, canvas) {
            var offsetX = 0, offsetY = 0, mx, my;

            if (canvas.offsetParent !== undefined) {
                do {
                    offsetX += canvas.offsetLeft;
                    offsetY += canvas.offsetTop;
                } while ((canvas = canvas.offsetParent));
            }

            mx = (e.pageX || e.touches[0].clientX) - offsetX;
            my = (e.pageY || e.touches[0].clientY) - offsetY;

            return {x: mx, y: my};
        }

        function handlePercentage(filledInPixels) {
            filledInPixels = filledInPixels || 0;
            console.log(filledInPixels + '%');
            if (filledInPixels > 50) {
                $("#top-header").addClass('show');
                $("#names").addClass('show');
                removeFadeOut(canvas, 500);
            }
        }

        function removeFadeOut(el, speed) {
            var seconds = speed / 1000;
            el.style.transition = "opacity " + seconds + "s ease";

            el.style.opacity = 0;
            setTimeout(function () {
                el.parentNode.removeChild(el);
            }, speed);
        }

        function handleMouseDown(e) {
            isDrawing = true;
            lastPoint = getMouse(e, canvas);
        }

        function handleMouseMove(e) {
            if (!isDrawing) {
                return;
            }

            e.preventDefault();

            var currentPoint = getMouse(e, canvas),
                dist = distanceBetween(lastPoint, currentPoint),
                angle = angleBetween(lastPoint, currentPoint),
                x, y;

            for (var i = 0; i < dist; i++) {
                x = lastPoint.x + (Math.sin(angle) * i) - 25;
                y = lastPoint.y + (Math.cos(angle) * i) - 25;
                ctx.globalCompositeOperation = 'destination-out';
                ctx.drawImage(brush, x, y);
            }

            lastPoint = currentPoint;
            handlePercentage(getFilledInPixels(32));
        }

        function handleMouseUp(e) {
            isDrawing = false;
        }

    })();
</script>
</html>